Loading training set...

Num images:  10164
Image shape: [3, 512, 512]
Label shape: [0]

Constructing networks...
Resuming from "afhqcat.pkl"
Setting up PyTorch plugin "bias_act_plugin"... Done.
Setting up PyTorch plugin "upfirdn2d_plugin"... Done.

Generator             Parameters  Buffers  Output shape        Datatype
---                   ---         ---      ---                 ---     
mapping.fc0           262656      -        [8, 512]            float32 
mapping.fc1           262656      -        [8, 512]            float32 
mapping               -           512      [8, 16, 512]        float32 
synthesis.b4.conv1    2622465     32       [8, 512, 4, 4]      float32 
synthesis.b4.torgb    264195      -        [8, 3, 4, 4]        float32 
synthesis.b4:0        8192        16       [8, 512, 4, 4]      float32 
synthesis.b4:1        -           -        [8, 512, 4, 4]      float32 
synthesis.b8.conv0    2622465     80       [8, 512, 8, 8]      float32 
synthesis.b8.conv1    2622465     80       [8, 512, 8, 8]      float32 
synthesis.b8.torgb    264195      -        [8, 3, 8, 8]        float32 
synthesis.b8:0        -           16       [8, 512, 8, 8]      float32 
synthesis.b8:1        -           -        [8, 512, 8, 8]      float32 
synthesis.b16.conv0   2622465     272      [8, 512, 16, 16]    float32 
synthesis.b16.conv1   2622465     272      [8, 512, 16, 16]    float32 
synthesis.b16.torgb   264195      -        [8, 3, 16, 16]      float32 
synthesis.b16:0       -           16       [8, 512, 16, 16]    float32 
synthesis.b16:1       -           -        [8, 512, 16, 16]    float32 
synthesis.b32.conv0   2622465     1040     [8, 512, 32, 32]    float32 
synthesis.b32.conv1   2622465     1040     [8, 512, 32, 32]    float32 
synthesis.b32.torgb   264195      -        [8, 3, 32, 32]      float32 
synthesis.b32:0       -           16       [8, 512, 32, 32]    float32 
synthesis.b32:1       -           -        [8, 512, 32, 32]    float32 
synthesis.b64.conv0   2622465     4112     [8, 512, 64, 64]    float16 
synthesis.b64.conv1   2622465     4112     [8, 512, 64, 64]    float16 
synthesis.b64.torgb   264195      -        [8, 3, 64, 64]      float16 
synthesis.b64:0       -           16       [8, 512, 64, 64]    float16 
synthesis.b64:1       -           -        [8, 512, 64, 64]    float32 
synthesis.b128.conv0  1442561     16400    [8, 256, 128, 128]  float16 
synthesis.b128.conv1  721409      16400    [8, 256, 128, 128]  float16 
synthesis.b128.torgb  132099      -        [8, 3, 128, 128]    float16 
synthesis.b128:0      -           16       [8, 256, 128, 128]  float16 
synthesis.b128:1      -           -        [8, 256, 128, 128]  float32 
synthesis.b256.conv0  426369      65552    [8, 128, 256, 256]  float16 
synthesis.b256.conv1  213249      65552    [8, 128, 256, 256]  float16 
synthesis.b256.torgb  66051       -        [8, 3, 256, 256]    float16 
synthesis.b256:0      -           16       [8, 128, 256, 256]  float16 
synthesis.b256:1      -           -        [8, 128, 256, 256]  float32 
synthesis.b512.conv0  139457      262160   [8, 64, 512, 512]   float16 
synthesis.b512.conv1  69761       262160   [8, 64, 512, 512]   float16 
synthesis.b512.torgb  33027       -        [8, 3, 512, 512]    float16 
synthesis.b512:0      -           16       [8, 64, 512, 512]   float16 
synthesis.b512:1      -           -        [8, 64, 512, 512]   float32 
---                   ---         ---      ---                 ---     
Total                 28700647    699904   -                   -       


Discriminator  Parameters  Buffers  Output shape        Datatype
---            ---         ---      ---                 ---     
b512.fromrgb   256         16       [8, 64, 512, 512]   float16 
b512.skip      8192        16       [8, 128, 256, 256]  float16 
b512.conv0     36928       16       [8, 64, 512, 512]   float16 
b512.conv1     73856       16       [8, 128, 256, 256]  float16 
b512           -           16       [8, 128, 256, 256]  float16 
b256.skip      32768       16       [8, 256, 128, 128]  float16 
b256.conv0     147584      16       [8, 128, 256, 256]  float16 
b256.conv1     295168      16       [8, 256, 128, 128]  float16 
b256           -           16       [8, 256, 128, 128]  float16 
b128.skip      131072      16       [8, 512, 64, 64]    float16 
b128.conv0     590080      16       [8, 256, 128, 128]  float16 
b128.conv1     1180160     16       [8, 512, 64, 64]    float16 
b128           -           16       [8, 512, 64, 64]    float16 
b64.skip       262144      16       [8, 512, 32, 32]    float16 
b64.conv0      2359808     16       [8, 512, 64, 64]    float16 
b64.conv1      2359808     16       [8, 512, 32, 32]    float16 
b64            -           16       [8, 512, 32, 32]    float16 
b32.skip       262144      16       [8, 512, 16, 16]    float32 
b32.conv0      2359808     16       [8, 512, 32, 32]    float32 
b32.conv1      2359808     16       [8, 512, 16, 16]    float32 
b32            -           16       [8, 512, 16, 16]    float32 
b16.skip       262144      16       [8, 512, 8, 8]      float32 
b16.conv0      2359808     16       [8, 512, 16, 16]    float32 
b16.conv1      2359808     16       [8, 512, 8, 8]      float32 
b16            -           16       [8, 512, 8, 8]      float32 
b8.skip        262144      16       [8, 512, 4, 4]      float32 
b8.conv0       2359808     16       [8, 512, 8, 8]      float32 
b8.conv1       2359808     16       [8, 512, 4, 4]      float32 
b8             -           16       [8, 512, 4, 4]      float32 
b4.mbstd       -           -        [8, 513, 4, 4]      float32 
b4.conv        2364416     16       [8, 512, 4, 4]      float32 
b4.fc          4194816     -        [8, 512]            float32 
b4.out         513         -        [8, 1]              float32 
---            ---         ---      ---                 ---     
Total          28982849    480      -                   -       

Setting up augmentation...
Distributing across 1 GPUs...
Setting up training phases...
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  7%|##6                                    | 23.0M/338M [00:00<00:01, 241MiB/s] 14%|#####3                                 | 46.0M/338M [00:00<00:01, 234MiB/s] 20%|#######8                               | 68.4M/338M [00:00<00:01, 216MiB/s] 26%|##########2                            | 89.1M/338M [00:00<00:01, 211MiB/s] 32%|############9                           | 109M/338M [00:00<00:01, 208MiB/s] 39%|###############5                        | 131M/338M [00:00<00:01, 216MiB/s] 45%|##################                      | 152M/338M [00:00<00:00, 214MiB/s] 51%|####################5                   | 174M/338M [00:00<00:00, 219MiB/s] 58%|#######################1                | 196M/338M [00:00<00:00, 222MiB/s] 64%|#########################7              | 217M/338M [00:01<00:00, 222MiB/s] 71%|############################3           | 239M/338M [00:01<00:00, 224MiB/s] 77%|##############################8         | 260M/338M [00:01<00:00, 223MiB/s] 83%|#################################3      | 282M/338M [00:01<00:00, 195MiB/s] 89%|###################################6    | 301M/338M [00:01<00:00, 197MiB/s] 95%|#####################################9  | 320M/338M [00:01<00:00, 170MiB/s]100%|#######################################9| 337M/338M [00:01<00:00, 161MiB/s]100%|########################################| 338M/338M [00:01<00:00, 199MiB/s]
  0%|                                               | 0.00/244M [00:00<?, ?iB/s]  0%|                                       | 32.0k/244M [00:00<15:57, 267kiB/s]  0%|                                       | 96.0k/244M [00:00<10:08, 420kiB/s]  0%|                                        | 160k/244M [00:00<08:58, 474kiB/s]  0%|                                        | 224k/244M [00:00<10:23, 410kiB/s]  0%|                                        | 288k/244M [00:00<11:05, 384kiB/s]  0%|                                        | 352k/244M [00:00<10:54, 390kiB/s]  0%|                                        | 416k/244M [00:01<10:23, 409kiB/s]  0%|                                        | 480k/244M [00:01<09:39, 440kiB/s]  0%|                                        | 576k/244M [00:01<08:08, 523kiB/s]  0%|1                                       | 672k/244M [00:01<06:57, 610kiB/s]  0%|1                                       | 752k/244M [00:01<06:52, 619kiB/s]  0%|1                                       | 848k/244M [00:01<06:50, 621kiB/s]  0%|1                                       | 944k/244M [00:01<06:21, 667kiB/s]  0%|1                                      | 1.08M/244M [00:01<05:12, 816kiB/s]  0%|1                                      | 1.17M/244M [00:02<05:24, 784kiB/s]  1%|1                                      | 1.25M/244M [00:02<05:40, 747kiB/s]  1%|2                                      | 1.33M/244M [00:02<05:42, 743kiB/s]  1%|2                                      | 1.47M/244M [00:02<04:50, 874kiB/s]  1%|2                                      | 1.56M/244M [00:02<04:55, 860kiB/s]  1%|2                                      | 1.69M/244M [00:02<04:51, 870kiB/s]  1%|2                                      | 1.81M/244M [00:02<04:29, 943kiB/s]  1%|3                                      | 1.94M/244M [00:03<04:28, 947kiB/s]  1%|3                                      | 2.03M/244M [00:03<04:32, 932kiB/s]  1%|3                                     | 2.17M/244M [00:03<03:57, 1.07MiB/s]  1%|3                                     | 2.33M/244M [00:03<03:47, 1.11MiB/s]  1%|3                                     | 2.48M/244M [00:03<03:37, 1.17MiB/s]  1%|4                                     | 2.64M/244M [00:03<03:29, 1.21MiB/s]  1%|4                                     | 2.84M/244M [00:03<03:06, 1.35MiB/s]  1%|4                                     | 3.00M/244M [00:03<03:11, 1.32MiB/s]  1%|5                                     | 3.52M/244M [00:03<01:47, 2.34MiB/s]  3%|#                                     | 6.88M/244M [00:04<00:22, 11.0MiB/s]  3%|#2                                    | 8.05M/244M [00:06<02:19, 1.77MiB/s]  4%|#4                                     | 8.90M/244M [00:08<04:09, 986kiB/s]  4%|#5                                    | 10.2M/244M [00:08<02:49, 1.45MiB/s]  6%|##3                                   | 15.4M/244M [00:08<00:59, 4.00MiB/s]  7%|##7                                    | 17.5M/244M [00:15<04:08, 956kiB/s]  8%|##9                                   | 19.0M/244M [00:15<03:29, 1.13MiB/s]  9%|###4                                  | 22.3M/244M [00:16<02:04, 1.86MiB/s] 10%|###7                                  | 24.0M/244M [00:18<02:36, 1.48MiB/s] 10%|###9                                  | 25.3M/244M [00:20<03:18, 1.16MiB/s] 11%|####1                                 | 26.9M/244M [00:20<02:30, 1.51MiB/s] 11%|####3                                 | 27.9M/244M [00:20<02:08, 1.76MiB/s] 13%|####9                                 | 32.0M/244M [00:20<01:07, 3.31MiB/s] 14%|#####1                                | 33.1M/244M [00:21<01:01, 3.61MiB/s] 14%|#####3                                | 34.1M/244M [00:21<00:54, 4.06MiB/s] 16%|######                                | 39.0M/244M [00:21<00:25, 8.34MiB/s] 17%|######4                               | 41.1M/244M [00:21<00:26, 8.05MiB/s] 18%|######6                               | 42.8M/244M [00:21<00:22, 9.18MiB/s] 20%|#######4                              | 48.0M/244M [00:21<00:14, 13.7MiB/s] 20%|#######7                              | 50.0M/244M [00:22<00:16, 12.3MiB/s] 23%|########7                             | 56.0M/244M [00:24<00:40, 4.88MiB/s] 23%|########9                             | 57.2M/244M [00:27<01:26, 2.26MiB/s] 24%|#########1                            | 58.6M/244M [00:27<01:14, 2.61MiB/s] 26%|#########8                            | 63.1M/244M [00:27<00:42, 4.43MiB/s] 27%|##########1                           | 65.1M/244M [00:27<00:39, 4.80MiB/s] 27%|##########3                           | 66.8M/244M [00:27<00:33, 5.61MiB/s] 30%|###########2                          | 72.0M/244M [00:29<00:52, 3.43MiB/s] 30%|###########4                          | 73.2M/244M [00:32<01:31, 1.97MiB/s] 31%|###########6                          | 74.8M/244M [00:32<01:13, 2.41MiB/s] 33%|############4                         | 79.7M/244M [00:32<00:39, 4.36MiB/s] 34%|############7                         | 81.9M/244M [00:33<00:51, 3.31MiB/s] 34%|#############                         | 83.5M/244M [00:34<00:53, 3.17MiB/s] 36%|#############7                        | 88.0M/244M [00:35<00:46, 3.49MiB/s] 36%|#############8                        | 89.0M/244M [00:36<00:54, 2.96MiB/s] 37%|#############9                        | 89.7M/244M [00:36<01:02, 2.57MiB/s] 37%|##############                        | 90.2M/244M [00:37<01:09, 2.33MiB/s] 37%|##############1                       | 90.6M/244M [00:37<01:09, 2.33MiB/s] 37%|##############1                       | 91.0M/244M [00:37<01:06, 2.40MiB/s] 39%|##############9                       | 96.0M/244M [00:37<00:22, 6.80MiB/s] 40%|###############1                      | 97.2M/244M [00:37<00:22, 6.71MiB/s] 41%|################1                      | 101M/244M [00:38<00:14, 10.6MiB/s] 43%|################6                      | 104M/244M [00:40<00:48, 3.06MiB/s] 43%|################8                      | 105M/244M [00:44<02:00, 1.21MiB/s] 44%|################9                      | 106M/244M [00:45<01:45, 1.37MiB/s] 46%|#################9                     | 112M/244M [00:45<00:49, 2.78MiB/s] 46%|##################                     | 113M/244M [00:47<01:16, 1.80MiB/s] 47%|##################1                    | 114M/244M [00:48<01:27, 1.57MiB/s] 47%|##################2                    | 114M/244M [00:48<01:31, 1.50MiB/s] 47%|##################2                    | 114M/244M [00:49<01:36, 1.41MiB/s] 47%|##################3                    | 115M/244M [00:49<01:39, 1.37MiB/s] 47%|##################3                    | 115M/244M [00:49<01:39, 1.36MiB/s] 47%|##################3                    | 115M/244M [00:49<01:38, 1.37MiB/s] 47%|##################4                    | 115M/244M [00:49<01:35, 1.41MiB/s] 49%|###################1                   | 120M/244M [00:52<01:14, 1.74MiB/s] 49%|###################2                   | 120M/244M [00:53<01:45, 1.23MiB/s] 49%|###################7                    | 120M/244M [00:54<02:20, 925kiB/s] 49%|###################7                    | 120M/244M [00:55<02:40, 809kiB/s] 49%|###################7                    | 120M/244M [00:55<03:08, 688kiB/s] 49%|###################7                    | 121M/244M [00:56<03:14, 666kiB/s] 49%|###################7                    | 121M/244M [00:56<03:32, 609kiB/s] 49%|###################7                    | 121M/244M [00:56<03:54, 551kiB/s] 49%|###################7                    | 121M/244M [00:56<04:29, 479kiB/s] 50%|###################4                   | 121M/244M [00:56<01:53, 1.13MiB/s] 51%|###################8                   | 124M/244M [00:57<00:24, 5.03MiB/s] 52%|####################4                  | 128M/244M [00:58<00:44, 2.72MiB/s] 53%|####################5                  | 129M/244M [01:00<01:25, 1.42MiB/s] 53%|####################6                  | 129M/244M [01:01<01:21, 1.48MiB/s] 55%|#####################2                 | 133M/244M [01:01<00:35, 3.23MiB/s] 56%|#####################7                 | 136M/244M [01:01<00:23, 4.85MiB/s] 56%|######################                 | 138M/244M [01:01<00:21, 5.18MiB/s] 57%|######################3                | 140M/244M [01:01<00:16, 6.52MiB/s] 58%|######################5                | 141M/244M [01:02<00:16, 6.35MiB/s] 59%|#######################                | 144M/244M [01:03<00:22, 4.61MiB/s] 59%|#######################1               | 145M/244M [01:03<00:22, 4.70MiB/s] 61%|#######################7               | 149M/244M [01:03<00:12, 8.00MiB/s] 62%|########################2              | 152M/244M [01:05<00:27, 3.49MiB/s] 63%|########################4              | 153M/244M [01:07<00:55, 1.73MiB/s] 64%|########################8              | 156M/244M [01:08<00:38, 2.42MiB/s] 66%|#########################5             | 160M/244M [01:08<00:21, 4.10MiB/s] 66%|#########################8             | 162M/244M [01:09<00:26, 3.28MiB/s] 67%|##########################             | 163M/244M [01:09<00:28, 3.03MiB/s] 69%|##########################8            | 168M/244M [01:11<00:29, 2.71MiB/s] 69%|##########################9            | 169M/244M [01:13<00:45, 1.74MiB/s] 69%|###########################            | 169M/244M [01:14<00:46, 1.70MiB/s] 70%|###########################4           | 172M/244M [01:14<00:27, 2.71MiB/s] 72%|############################1          | 176M/244M [01:16<00:30, 2.31MiB/s] 72%|############################2          | 177M/244M [01:18<00:49, 1.43MiB/s] 73%|############################3          | 177M/244M [01:19<00:45, 1.55MiB/s] 73%|############################4          | 178M/244M [01:19<00:41, 1.68MiB/s] 75%|#############################3         | 184M/244M [01:19<00:14, 4.49MiB/s] 76%|#############################6         | 186M/244M [01:25<00:57, 1.07MiB/s] 77%|##############################         | 188M/244M [01:25<00:39, 1.47MiB/s] 78%|##############################6        | 191M/244M [01:26<00:23, 2.35MiB/s] 79%|##############################9        | 194M/244M [01:30<00:42, 1.25MiB/s] 80%|###############################3       | 196M/244M [01:30<00:30, 1.67MiB/s] 81%|###############################5       | 198M/244M [01:30<00:23, 2.09MiB/s] 82%|###############################9       | 200M/244M [01:32<00:26, 1.73MiB/s] 82%|################################1      | 201M/244M [01:35<00:41, 1.09MiB/s] 83%|################################4      | 203M/244M [01:35<00:29, 1.47MiB/s] 85%|#################################2     | 208M/244M [01:36<00:12, 2.99MiB/s] 86%|#################################4     | 209M/244M [01:37<00:15, 2.27MiB/s] 86%|#################################6     | 210M/244M [01:38<00:17, 2.06MiB/s] 87%|#################################7     | 211M/244M [01:38<00:16, 2.12MiB/s] 89%|##################################5    | 216M/244M [01:38<00:06, 4.34MiB/s] 89%|##################################7    | 217M/244M [01:38<00:05, 4.77MiB/s] 92%|###################################8   | 224M/244M [01:40<00:05, 4.01MiB/s] 92%|###################################9   | 225M/244M [01:43<00:09, 2.01MiB/s] 92%|####################################   | 226M/244M [01:43<00:09, 2.06MiB/s] 93%|####################################2  | 227M/244M [01:43<00:06, 2.57MiB/s] 95%|#####################################  | 232M/244M [01:45<00:05, 2.47MiB/s] 95%|#####################################1 | 233M/244M [01:47<00:07, 1.59MiB/s] 96%|#####################################2 | 233M/244M [01:48<00:07, 1.54MiB/s] 96%|#####################################4 | 234M/244M [01:48<00:05, 1.86MiB/s] 98%|######################################1| 239M/244M [01:48<00:01, 4.10MiB/s] 98%|######################################4| 240M/244M [01:51<00:02, 1.63MiB/s] 99%|######################################6| 242M/244M [01:52<00:01, 1.66MiB/s]100%|#######################################| 244M/244M [01:52<00:00, 2.27MiB/s]
  0%|                                               | 0.00/335M [00:00<?, ?iB/s]  4%|#7                                     | 14.7M/335M [00:00<00:02, 154MiB/s]  9%|###4                                   | 29.4M/335M [00:00<00:02, 111MiB/s] 13%|#####1                                 | 44.6M/335M [00:00<00:02, 129MiB/s] 17%|######8                                | 58.5M/335M [00:00<00:02, 134MiB/s] 22%|########4                              | 72.9M/335M [00:00<00:01, 140MiB/s] 26%|##########                             | 86.6M/335M [00:00<00:01, 140MiB/s] 30%|###########9                            | 100M/335M [00:00<00:01, 137MiB/s] 34%|#############5                          | 113M/335M [00:00<00:01, 138MiB/s] 38%|###############1                        | 127M/335M [00:01<00:01, 127MiB/s] 42%|################7                       | 140M/335M [00:01<00:01, 132MiB/s] 46%|##################3                     | 153M/335M [00:01<00:01, 131MiB/s] 50%|###################8                    | 166M/335M [00:01<00:01, 126MiB/s] 53%|#####################3                  | 179M/335M [00:01<00:01, 129MiB/s] 57%|######################9                 | 192M/335M [00:01<00:01, 132MiB/s] 61%|########################4               | 205M/335M [00:01<00:01, 132MiB/s] 65%|#########################9              | 217M/335M [00:01<00:01, 116MiB/s] 69%|###########################7            | 232M/335M [00:01<00:00, 126MiB/s] 73%|#############################2          | 244M/335M [00:01<00:00, 125MiB/s] 77%|##############################8         | 258M/335M [00:02<00:00, 129MiB/s] 81%|################################3       | 270M/335M [00:02<00:00, 126MiB/s] 85%|#################################8      | 283M/335M [00:02<00:00, 129MiB/s] 89%|###################################4    | 296M/335M [00:02<00:00, 132MiB/s] 92%|####################################9   | 309M/335M [00:02<00:00, 127MiB/s] 97%|######################################6 | 323M/335M [00:02<00:00, 133MiB/s]100%|########################################| 335M/335M [00:02<00:00, 129MiB/s]
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Downloading: "https://download.pytorch.org/models/alexnet-owt-4df8aa71.pth" to /root/.cache/torch/hub/checkpoints/alexnet-owt-4df8aa71.pth
  0%|          | 0.00/233M [00:00<?, ?B/s] 11%|#1        | 25.9M/233M [00:00<00:00, 272MB/s] 24%|##4       | 57.1M/233M [00:00<00:00, 304MB/s] 38%|###8      | 89.5M/233M [00:00<00:00, 320MB/s] 52%|#####1    | 120M/233M [00:00<00:00, 296MB/s]  65%|######5   | 152M/233M [00:00<00:00, 309MB/s] 78%|#######7  | 182M/233M [00:00<00:00, 306MB/s] 90%|######### | 211M/233M [00:00<00:00, 304MB/s]100%|##########| 233M/233M [00:00<00:00, 309MB/s]
Loading model from: /usr/local/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Exporting sample images...
Initializing logs...
Skipping tfevents export: No module named 'tensorboard'
Training for 25000 kimg...

tick 0     kimg 0.0      time 5m 23s       sec/tick 37.2    sec/kimg 4655.26 maintenance 286.2  cpumem 5.30   gpumem 35.32  augment 0.000
Evaluating metrics...
